<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 520" width="1000" height="520" role="img" aria-label="Diagrama Amplify Cognito AppSync DynamoDB">
  <style>
    <![CDATA[
      .bg{fill:#fff;}
      .canvas{font-family: Inter, Roboto, Arial; color:#0b2545}
      .box{fill:#e6f0ff;stroke:#2b6cb0;stroke-width:1.6;rx:10;ry:10}
      .box-auth{fill:#fff3cd;stroke:#d69e2e;stroke-width:1.6;rx:10;ry:10}
      .box-db{fill:#e6fff2;stroke:#059669;stroke-width:1.6;rx:10;ry:10}
      .label{font-size:12px;fill:#07203a;font-weight:700}
      .sub{font-size:11px;fill:#23455f}
      .arrow{stroke:#0b2545;stroke-width:1.6;fill:none;marker-end:url(#arrow)}
      .badge{font-size:11px;fill:#0b2545;font-weight:700}
      .note{font-size:12px;fill:#475569}
    ]]>
  </style>

  <defs>
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#0b2545"/>
    </marker>
  </defs>

  <!-- Canvas background -->
  <rect x="0" y="0" width="1000" height="520" fill="#f5f7fb"/>

  <!-- Browser / Frontend -->
  <g class="canvas">
    <rect x="28" y="36" width="220" height="110" class="box"/>
    <text x="138" y="66" text-anchor="middle" class="label">Navegador / App</text>
    <text x="138" y="88" text-anchor="middle" class="sub">HTML estático (Amplify Hosting)</text>

    <rect x="92" y="108" width="116" height="20" rx="8" fill="#eef2ff" stroke="#2b6cb0"/>
    <text x="150" y="122" text-anchor="middle" class="badge">Amplify JS (Auth + API)</text>
  </g>

  <!-- Amplify Hosting -->
  <g class="canvas">
    <rect x="280" y="36" width="180" height="110" class="box"/>
    <text x="370" y="66" text-anchor="middle" class="label">AWS Amplify Hosting</text>
    <text x="370" y="88" text-anchor="middle" class="sub">Distribuye contenido estático (HTML/CSS/JS)</text>
  </g>

  <!-- Cognito -->
  <g class="canvas">
    <rect x="520" y="20" width="240" height="140" class="box-auth"/>
    <text x="640" y="46" text-anchor="middle" class="label">Amazon Cognito</text>
    <text x="640" y="66" text-anchor="middle" class="sub">User Pool (auth) + Identity Pool (credenciales)</text>

    <rect x="540" y="82" width="80" height="30" rx="6" fill="#fff" stroke="#d69e2e"/>
    <text x="580" y="102" text-anchor="middle" class="sub">JWT (ID / Access)</text>

    <rect x="640" y="82" width="80" height="30" rx="6" fill="#fff" stroke="#d69e2e"/>
    <text x="680" y="102" text-anchor="middle" class="sub">Cognito Identity</text>
  </g>

  <!-- AppSync -->
  <g class="canvas">
    <rect x="520" y="190" width="240" height="110" class="box"/>
    <text x="640" y="216" text-anchor="middle" class="label">AWS AppSync</text>
    <text x="640" y="238" text-anchor="middle" class="sub">GraphQL API (autoriza con JWT)</text>
  </g>

  <!-- DynamoDB -->
  <g class="canvas">
    <rect x="800" y="210" width="150" height="90" class="box-db"/>
    <text x="875" y="236" text-anchor="middle" class="label">DynamoDB</text>
    <text x="875" y="256" text-anchor="middle" class="sub">Tablas (Items / Índices)</text>
  </g>

  <!-- Arrows / Flows -->
  <path d="M 248 92 L 280 92" class="arrow"/>

  <path d="M 170 146 L 520 146" class="arrow"/>
  <text x="346" y="134" text-anchor="middle" class="sub">Inicia sesión (username/password, OAuth)</text>

  <path d="M 640 152 L 260 152" class="arrow"/>
  <text x="470" y="166" text-anchor="middle" class="sub">JWT / tokens devueltos al frontend</text>

  <path d="M 260 190 L 520 246" class="arrow"/>
  <text x="380" y="220" text-anchor="middle" class="sub">Amplify.API.graphql (Authorization: Bearer &lt;JWT&gt;)</text>

  <path d="M 760 245 L 800 245" class="arrow"/>
  <text x="780" y="258" text-anchor="middle" class="sub">Data resolvers (VTL / Lambda) → DynamoDB</text>

  <text x="640" y="330" text-anchor="middle" class="sub">AppSync resuelve operaciones (Query/Mutation) y persiste en DynamoDB</text>

  <!-- Legend / Notes -->
  <g>
    <rect x="28" y="360" width="940" height="120" rx="8" fill="#fbfcff" stroke="#e6eef8"/>
    <text x="50" y="388" class="label">Notas de arquitectura</text>
    <text x="50" y="408" class="sub">• La app estática (hosted en Amplify) usa Amplify JS para autenticarse contra Cognito y obtener tokens JWT.</text>
    <text x="50" y="426" class="sub">• Las llamadas GraphQL a AppSync deben incluir el token de Cognito (Authorization header) para autorizar el request.</text>
    <text x="50" y="444" class="sub">• AppSync puede resolver directamente contra DynamoDB (resolvers VTL) o invocar Lambdas si la lógica lo requiere.</text>
    <text x="50" y="462" class="sub">• Para permisos finos, use IAM roles vinculados a Cognito Identity Pool o políticas de AppSync.</text>
  </g>

</svg>

